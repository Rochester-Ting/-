(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-733a3c05"],{"0525":function(e,t,r){},"34b8":function(e,t,r){"use strict";r("0525")},b700:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"house-page-save-base-info"},[r("el-form",{ref:"ruleForm",attrs:{model:e.formObj,rules:e.formRules,"label-width":"100px","label-position":"top"}},[r("h5",[e._v("房源地址")]),r("el-form-item",{attrs:{label:"省市区 ",prop:"ssq"}},[r("el-cascader",{staticStyle:{width:"400px"},attrs:{options:e.optionsArea},on:{change:e.changeSSQ},model:{value:e.formObj.ssq,callback:function(t){e.$set(e.formObj,"ssq",t)},expression:"formObj.ssq"}})],1),r("el-form-item",{attrs:{label:"项目地址 ",prop:"community"}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.formObj.community,callback:function(t){e.$set(e.formObj,"community",t)},expression:"formObj.community"}})],1),r("el-form-item",{attrs:{label:"地图标记 ",prop:"name"}},[r("div",{staticClass:"amap-page-container",staticStyle:{width:"100%"}},[r("el-amap",{staticStyle:{height:"300px"},attrs:{events:e.events,center:e.formObj.longitude?[e.formObj.longitude,e.formObj.latitude]:e.center,vid:"amap",plugin:e.plugin}},[r("el-amap-marker",{attrs:{position:e.formObj.longitude?[e.formObj.longitude,e.formObj.latitude]:e.center}})],1),r("div",{staticClass:"toolbar"},[e.loaded?e._e():r("span",[e._v("正在定位")])])],1)]),r("el-divider"),r("h5",[e._v("基本信息")]),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"项目编号 ",prop:"projectNo"}},[r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入内容"},model:{value:e.formObj.projectNo,callback:function(t){e.$set(e.formObj,"projectNo",t)},expression:"formObj.projectNo"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"项目名称 ",prop:"name"}},[r("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入内容"},model:{value:e.formObj.name,callback:function(t){e.$set(e.formObj,"name",t)},expression:"formObj.name"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"门店电话 ",prop:"phone"}},[r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入内容"},model:{value:e.formObj.phone,callback:function(t){e.$set(e.formObj,"phone",t)},expression:"formObj.phone"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"品牌 ",prop:"brand"}},[r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入内容"},model:{value:e.formObj.brand,callback:function(t){e.$set(e.formObj,"brand",t)},expression:"formObj.brand"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"水费单价 ",prop:"waterPrice"}},[r("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入内容"},model:{value:e.formObj.waterPrice,callback:function(t){e.$set(e.formObj,"waterPrice",t)},expression:"formObj.waterPrice"}}),e._v("\n          元/m³\n        ")],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"电费单价 ",prop:"electricityPrice"}},[r("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入内容"},model:{value:e.formObj.electricityPrice,callback:function(t){e.$set(e.formObj,"electricityPrice",t)},expression:"formObj.electricityPrice"}}),e._v("\n          元/度\n        ")],1)],1)],1),r("el-table",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{data:e.formObj.projectBuildingList.concat([{buildingNo:"",maxFloor:"",floorRoomCount:"",status:-1e4}]),border:!0}},[r("el-table-column",{attrs:{prop:"buildingNo",label:"楼号"},scopedSlots:e._u([{key:"default",fn:function(t){return[-1e4===t.row.status?r("el-input",{attrs:{placeholder:"请输入楼号"},model:{value:t.row.buildingNo,callback:function(r){e.$set(t.row,"buildingNo",r)},expression:"scope.row.buildingNo"}}):r("div",[e._v(e._s(t.row.buildingNo))])]}}])}),r("el-table-column",{attrs:{prop:"maxFloor",label:"最高层数",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[-1e4===t.row.status?r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.row.maxFloor,callback:function(r){e.$set(t.row,"maxFloor",r)},expression:"scope.row.maxFloor"}}):r("div",[e._v(e._s(t.row.maxFloor))])]}}])}),r("el-table-column",{attrs:{prop:"floorRoomCount",label:"房间数",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[-1e4===t.row.status?r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.row.floorRoomCount,callback:function(r){e.$set(t.row,"floorRoomCount",r)},expression:"scope.row.floorRoomCount"}}):r("div",[e._v(e._s(t.row.floorRoomCount))])]}}])}),r("el-table-column",{attrs:{prop:"floorRoomCount",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"\n              justify-content-center\n              align-items-center\n              house-save-operations\n            "},[-1e4===t.row.status?r("span",{staticClass:"btn btn-link",on:{click:function(r){r.stopPropagation(),e.addBuildingInfoClick(t)}}},[e._v("添加\n            ")]):e._e(),t.row.isDelete?r("div",{on:{click:function(r){r.stopPropagation(),e.delBuildingInfoClick(t)}}},[r("el-link",{attrs:{type:"primary"}},[r("i",{staticClass:"iconfont cursor-pointer el-icon-delete"})])],1):e._e()]),"edit"===e.currentType?r("div",{staticClass:"\n              justify-content-center\n              align-items-center\n              house-save-operations\n            "},[r("span",{directives:[{name:"show",rawName:"v-show",value:1===Number(t.row.status)&&!t.row.isDelete,expression:"Number(scope.row.status) === 1 && !scope.row.isDelete"}],staticClass:"btn btn-link-danger",on:{click:function(r){r.stopPropagation(),e.initStopInfo(t)}}},[e._v("停用\n            ")]),r("span",{directives:[{name:"show",rawName:"v-show",value:0===Number(t.row.status),expression:"Number(scope.row.status) === 0"}],staticClass:"btn btn-link",on:{click:function(r){r.stopPropagation(),e.initSuccessInfo(t)}}},[e._v("启用\n            ")])]):e._e()]}}])})],1),r("el-form-item",[r("div",{staticClass:"notice"},[e._v("注意：楼号信息保存后不可修改！")])]),r("el-form-item",{attrs:{label:"项目图片：",prop:"fileList"}},[r("el-upload",{staticClass:"upload-demo",attrs:{"on-exceed":e.handleExceed,"on-remove":e.handleRemove,"on-success":e.uploadSuccess,"on-error":e.uploadError,"file-list":e.imgsUrl,drag:"",action:e.baseUrl+"sys/file/upload?type=image",multiple:"",limit:10,"list-type":"picture"}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[e._v("\n          将文件拖到此处，或\n          "),r("em",[e._v("点击上传")])]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件")])])],1),r("el-form-item",{attrs:{label:"项目介绍",prop:"intro"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.formObj.intro,callback:function(t){e.$set(e.formObj,"intro",t)},expression:"formObj.intro"}})],1)],1),r("div",{staticClass:"border-top mt-5 pt-10"},[r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{staticClass:"btn btn-primary font-weight-bolder text-uppercase px-9 py-4",attrs:{loading:e.submitLoading},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("\n        提 交\n      ")])],1)])],1)},n=[],i=(r("ac4d"),r("8a81"),r("5df3"),r("1c4c"),r("7f7f"),r("6b54"),r("2397"),r("c5f6"),r("96cf"),r("1da1")),a=r("d4ec"),s=r("bee2"),l=r("262e"),c=r("99de"),u=r("7e84"),f=r("9ab4"),m=r("60a3"),d=r("ef6c"),p=(r("a872"),r("aa68"));function b(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=g(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function g(e,t){if(e){if("string"===typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function v(e){var t=j();return function(){var r,o=Object(u["a"])(e);if(t){var n=Object(u["a"])(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Object(c["a"])(this,r)}}function j(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var y=null,O=function(e){Object(l["a"])(r,e);var t=v(r);function r(){var e;return Object(a["a"])(this,r),e=t.apply(this,arguments),e.optionsArea=d["regionData"],e.loaded=!1,e.formObj={ssq:[],address:"2222",area:"",city:"",province:"",brand:"",intro:"",name:"",phone:"",projectNo:"",community:"",waterPrice:"",electricityPrice:"",projectBuildingList:[],fileList:[{url:""}],status:0,latitude:"",longitude:""},e.center=[121.59996,31.197646],e.imgsUrl=[],e.submitLoading=!1,e.formRules={ssq:[{type:"array",required:!0,message:"请选择省市区",trigger:"change"}],brand:[{required:!0,message:"请输入品牌",trigger:"change"}],waterPrice:[{required:!0,message:"请输入水费",trigger:"change"}],electricityPrice:[{required:!0,message:"请输入电费",trigger:"change"}],intro:[{required:!0,message:"请输入项目介绍",trigger:"change"}],name:[{required:!0,message:"请输入项目名称",trigger:"change"}],phone:[{required:!0,message:"请输入门店电话",trigger:"change"}],projectNo:[{required:!0,message:"请输入项目编号",trigger:"change"}],community:[{required:!0,message:"请输入项目地址",trigger:"change"}],buildingNo:{required:!0,message:"楼号不能为空",trigger:"change"},maxFloor:{required:!0,message:"楼层不能为空",trigger:"change"},floorRoomCount:{required:!0,message:"每层房间数不能为空",trigger:"change"},fileList:{required:!0}},e}return Object(s["a"])(r,[{key:"mounted",value:function(){this.projectId&&this.getProjectData()}},{key:"currentType",get:function(){return m["d"].ls.get("/house/save").type}},{key:"getProjectData",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(p["d"])({id:this.projectId});case 2:t=e.sent,200===t.code&&(this.imgsUrl=t.data.fileList,this.giveImageUrlsAddDomian(),this.formObj=t.data,this.formObj.ssq=[t.data.province,t.data.city,t.data.area]);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"submitForm",value:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;1!==t.formObj.fileList.length||t.formObj.fileList[0].url||(t.formObj.fileList=[]),t.requestSubmitPost()}))}},{key:"findNode",value:function(e,t){var r,o=b(e);try{for(o.s();!(r=o.n()).done;){var n=r.value;if(t(n))return n;if(n.children){var i=this.findNode(n.children,t);if(i)return i}}}catch(a){o.e(a)}finally{o.f()}return null}},{key:"requestSubmitPost",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.submitLoading=!0,this.formObj.ssq.length>0&&(this.formObj.province=this.formObj.ssq[0],this.formObj.ssq.length>1&&(this.formObj.city=this.formObj.ssq[1]),this.formObj.ssq.length>2&&(this.formObj.area=this.formObj.ssq[2])),e.prev=2,e.next=5,Object(p["h"])(this.formObj);case 5:if(t=e.sent,200!==t.code){e.next=15;break}if(this.$message.success("保存成功"),sessionStorage.setItem("canStep","1"),this.submitLoading=!1,"edit"!==this.currentType){e.next=12;break}return e.abrupt("return");case 12:this.$emit("nextStep",2,t.data),e.next=16;break;case 15:this.$message.error(t.msg);case 16:this.submitLoading=!1,e.next=23;break;case 19:e.prev=19,e.t0=e["catch"](2),this.$message.error(e.t0.msg),this.submitLoading=!1;case 23:case"end":return e.stop()}}),e,this,[[2,19]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"delBuildingInfoClick",value:function(e){this.formObj.projectBuildingList.splice(e.$index,1)}},{key:"addBuildingInfoClick",value:function(e){this.formObj.projectBuildingList.push({buildingNo:e.row.buildingNo,maxFloor:e.row.maxFloor,floorRoomCount:e.row.floorRoomCount,status:1,isDelete:!0})}},{key:"initStopInfo",value:function(e){"edit"===this.currentType&&(this.formObj.projectBuildingList[e.$index].status="0")}},{key:"initSuccessInfo",value:function(e){"edit"===this.currentType&&(this.formObj.projectBuildingList[e.$index].status="1")}},{key:"baseUrl",get:function(){return"http://www.immvisa.com.cn:8084/"}},{key:"giveImageUrlsAddDomian",value:function(){var e,t=b(this.imgsUrl);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.url="http://sayhi-room.oss-cn-qingdao.aliyuncs.com/"+r.url}}catch(o){t.e(o)}finally{t.f()}}},{key:"handleExceed",value:function(e){console.log(e),this.$message.warning("上传图片超出数量")}},{key:"handleRemove",value:function(e,t){this.formObj.fileList=[];var r,o=b(t);try{for(o.s();!(r=o.n()).done;){var n=r.value;this.formObj.fileList.push({url:n.response.data})}}catch(i){o.e(i)}finally{o.f()}}},{key:"uploadSuccess",value:function(e,t,r){1===this.formObj.fileList.length&&""===this.formObj.fileList[0].url&&(this.formObj.fileList=[]),this.formObj.fileList.push({url:t.response.data}),console.log("imgrurl",this.imgsUrl)}},{key:"uploadError",value:function(e,t,r){this.$message.error("上传出错, 请删除后继续")}},{key:"changeSSQ",value:function(e){var t=this,r=this.findNode(d["regionData"],(function(t){return t.value===e[0]})),o=this.findNode(d["regionData"],(function(t){return t.value===e[1]})),n=this.findNode(d["regionData"],(function(t){return t.value===e[2]}));y&&this.$confirm("是否将地图切换到选择的省市区?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t;y.getLocation(r.label+o.label+n.label,(function(t,r){if("complete"===t&&r.geocodes.length){var o=r.geocodes[0].location;e.formObj.longitude=o.lng,e.formObj.latitude=o.lat,e.center=[o.lng,o.lat],e.$nextTick()}}))})).catch((function(){}))}}]),r}(m["d"]);f["a"]([Object(m["c"])({type:[Number,String],default:""})],O.prototype,"projectId",void 0),O=f["a"]([Object(m["a"])({data:function(){var e=this;return{plugin:[{pName:"Geocoder",events:{init:function(e){y=e}}},{enableHighAccuracy:!0,timeout:1e3,maximumAge:0,convert:!0,showButton:!0,buttonPosition:"RB",showMarker:!0,showCircle:!0,panToLocation:!0,zoomToAccuracy:!0,extensions:"all",pName:"Geolocation",events:{init:function(t){e.formObj.longitude&&e.formObj.latitude||t.getCurrentPosition((function(t,r){r&&r.position&&(e.formObj.longitude=r.position.lng,e.formObj.latitude=r.position.lat,e.loaded=!0,e.$nextTick())}))}}}],events:{click:function(t){var r=t.lnglat,o=r.lng,n=r.lat;e.formObj.longitude=o,e.formObj.latitude=n,y&&y.getAddress([o,n],(function(t,r){"complete"===t&&"OK"===r.info&&r&&r.regeocode&&(console.log("result",r),e.formObj.ssq=[e.findNode(d["regionData"],(function(e){return e.label===r.regeocode.addressComponent.province})).value,e.findNode(d["regionData"],(function(e){return e.label===r.regeocode.addressComponent.city})).value,e.findNode(d["regionData"],(function(e){return e.label===r.regeocode.addressComponent.district})).value],e.formObj.community=r.regeocode.formattedAddress,e.$nextTick())}))}}}},components:{}})],O);var w=O,x=w,k=(r("34b8"),r("2877")),C=Object(k["a"])(x,o,n,!1,null,"7cfed321",null);t["default"]=C.exports}}]);
//# sourceMappingURL=chunk-733a3c05.5b277cd5.js.map